sap.ui.define(["ui5lab/browser/controller/BaseController","sap/ui/model/json/JSONModel","ui5lab/browser/model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/library"],function(e,t,i,s,a,r){"use strict";return e.extend("ui5lab.browser.controller.SampleList",{formatter:i,onInit:function(){var e,i,s=this.byId("table");i=s.getBusyIndicatorDelay();this._oTable=s;this._oTableSearchState=[];e=new t({fullscreen:false,title:this.getResourceBundle().getText("sampleListViewTitle"),sampleListTableTitle:this.getResourceBundle().getText("sampleListTableTitle"),shareSendEmailSubject:this.getResourceBundle().getText("shareSendEmailSampleListSubject","..."),shareSendEmailMessage:this.getResourceBundle().getText("shareSendEmailSampleListMessage",location.href),tableNoDataText:this.getResourceBundle().getText("tableNoDataText"),tableBusyDelay:0});this.setModel(e,"sampleListView");s.attachEventOnce("updateFinished",function(){e.setProperty("/tableBusyDelay",i)});this.getRouter().getRoute("sampleList").attachPatternMatched(this._onSampleListMatched,this);this.getRouter().getRoute("object").attachPatternMatched(this._onObjectMatched,this)},onUpdateFinished:function(e){var t,i=this.getModel("sampleListView"),s=e.getSource(),a=e.getParameter("total");if(a&&s.getBinding("items").isLengthFinal()){t=this.getResourceBundle().getText("sampleListTableTitleCount",[a])}else{t=this.getResourceBundle().getText("sampleListTableTitle")}i.setProperty("/sampleListTableTitle",t)},onPress:function(e){this._showObject(e.getSource())},toggleFullScreen:function(){var e=this.getModel("sampleListView");var t=e.getProperty("/fullscreen");e.setProperty("/fullscreen",!t);if(!t){this.getModel("appView").setProperty("/previousLayout",this.getModel("appView").getProperty("/layout"));this.getModel("appView").setProperty("/layout","MidColumnFullScreen")}else{this.getModel("appView").setProperty("/layout",this.getModel("appView").getProperty("/previousLayout"))}},onClose:function(){this.getModel("appView").setProperty("/helpVisible",true);this.getRouter().navTo("home");this.getModel("appView").setProperty("/layout","OneColumn")},onHelp:function(){r.URLHelper.redirect("https://ui5lab.io/docs/",true)},onHowTo:function(){r.URLHelper.redirect("https://ui5lab.io/docs/#/how_to/consume_library",true)},onToggleGroupByAsset:function(e){var t=this._oTable.getBinding("items");if(!this.__fnGroup){this.__fnGroup=t.aSorters[0].fnGroup}t.aSorters[0].sPath=e.getParameter("pressed")?"asset":"name";t.aSorters[0].fnGroup=e.getParameter("pressed")?this.__fnGroup:null;t.aSorters[0].vGroup=e.getParameter("pressed");t.sort(t.aSorters)},onNavBack:function(){history.go(-1)},onSearch:function(e){if(e.getParameters().refreshButtonPressed){this.onRefresh()}else{var t=[];var i=e.getParameter("newValue")||e.getParameter("search");if(i&&i.length>0){t=[new s({filters:[new s("name",a.Contains,i),new s("description",a.Contains,i)],and:false})]}this._applySearch(t)}},onRefresh:function(){this._oTable.getBinding("items").refresh()},getGroupHeader:function(e){var t=this.getModel().getData().assets.filter(function(t){return t.id===e.key}).pop();return new sap.m.GroupHeaderListItem({title:e.key+(t?" - "+t.description:""),upperCase:false})},_onSampleListMatched:function(e){var t=e.getParameter("arguments").libraryId,i=this.getModel("sampleListView"),r=this.getView().getParent().getParent();this.getModel().loaded().then(function(){var e=new s("library",a.Contains,t);this._oTable.getBinding("items").filter(e)}.bind(this));i.setProperty("/title",this.getResourceBundle().getText("sampleListViewTitle",t));this.getModel("sampleListView").setProperty("shareSendEmailSubject",this.getResourceBundle().getText("shareSendEmailSampleListSubject",t));this.getModel("sampleListView").setProperty("shareSendEmailMessage",this.getResourceBundle().getText("shareSendEmailSampleListMessage",location.href));r.setLayout(sap.f.LayoutType.TwoColumnsMidExpanded)},_onObjectMatched:function(e){var t=e.getParameter("arguments").libraryId;this.getModel().loaded().then(function(){var e=new s("library",a.Contains,t);this._oTable.getBinding("items").filter(e)}.bind(this))},_showObject:function(e){this.getRouter().navTo("object",{libraryId:e.getBindingContext().getProperty("library"),objectId:e.getBindingContext().getProperty("id")})},_applySearch:function(e){var t=this.getModel("sampleListView");this._oTable.getBinding("items").filter(e,"Application");if(e.length!==0){t.setProperty("/tableNoDataText",this.getResourceBundle().getText("sampleListNoDataWithSearchText"))}}})});